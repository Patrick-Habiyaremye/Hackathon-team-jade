(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{4302:function(e,t,o){Promise.resolve().then(o.bind(o,9560)),Promise.resolve().then(o.bind(o,4108)),Promise.resolve().then(o.t.bind(o,8326,23)),Promise.resolve().then(o.t.bind(o,1371,23)),Promise.resolve().then(o.t.bind(o,2853,23))},9560:function(e,t,o){"use strict";o.r(t),o.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var a=o(7437),r=o(2265),i=o(4033);let s=(0,r.createContext)(void 0);function AuthProvider(e){let{children:t}=e,[o,n]=(0,r.useState)(null),[c,u]=(0,r.useState)(!0),l=(0,i.useRouter)();(0,r.useEffect)(()=>{checkAuth()},[]);let checkAuth=async()=>{try{let e=localStorage.getItem("token");if(!e){u(!1);return}let t=await fetch("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();n(e)}else localStorage.removeItem("token")}catch(e){console.error("Auth check failed:",e),localStorage.removeItem("token")}finally{u(!1)}},login=async(e,t)=>{try{let o=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await o.json();if(o.ok)return localStorage.setItem("token",a.token),n(a.user),{success:!0,message:"Login successful"};return{success:!1,message:a.message||"Login failed"}}catch(e){return{success:!1,message:"Network error"}}},register=async e=>{try{let t=new AbortController,o=setTimeout(()=>t.abort(),15e3),a=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:t.signal});clearTimeout(o);let r={};try{r=await a.json()}catch(e){}if(a.ok)return{success:!0,message:"Registration successful"};{let e=(null==r?void 0:r.message)||"Request failed (".concat(a.status,")");return{success:!1,message:e}}}catch(e){if((null==e?void 0:e.name)==="AbortError")return{success:!1,message:"Request timed out. Please try again."};return{success:!1,message:(null==e?void 0:e.message)||"Network error"}}},claimAdmin=async(e,t)=>{try{let o=await fetch("/api/auth/claim-admin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,code:t})}),a=await o.json();if(o.ok)return localStorage.setItem("token",a.token),n(a.user),{success:!0,message:"Admin access granted"};return{success:!1,message:a.message||"Admin claim failed"}}catch(e){return{success:!1,message:"Network error"}}};return(0,a.jsx)(s.Provider,{value:{user:o,loading:c,login,register,logout:()=>{localStorage.removeItem("token"),n(null),l.push("/")},claimAdmin},children:t})}function useAuth(){let e=(0,r.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4108:function(e,t,o){"use strict";o.r(t),o.d(t,{NotificationProvider:function(){return NotificationProvider},useNotifications:function(){return useNotifications}});var a=o(7437),r=o(2265),i=o(9560);let s=(0,r.createContext)(void 0);function NotificationProvider(e){let{children:t}=e,[o,n]=(0,r.useState)([]),{user:c}=(0,i.useAuth)(),u=o.filter(e=>!e.isRead).length;(0,r.useEffect)(()=>{c&&fetchNotifications()},[c]);let fetchNotifications=async()=>{try{let e=localStorage.getItem("token"),t=await fetch("/api/notifications",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();n(e)}}catch(e){console.error("Failed to fetch notifications:",e)}},markAsRead=async e=>{try{let t=localStorage.getItem("token"),o=await fetch("/api/notifications/".concat(e,"/read"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t)}});o.ok&&n(t=>t.map(t=>t.id===e?{...t,isRead:!0}:t))}catch(e){console.error("Failed to mark notification as read:",e)}},markAllAsRead=async()=>{try{let e=localStorage.getItem("token"),t=await fetch("/api/notifications/read-all",{method:"PATCH",headers:{Authorization:"Bearer ".concat(e)}});t.ok&&n(e=>e.map(e=>({...e,isRead:!0})))}catch(e){console.error("Failed to mark all notifications as read:",e)}};return(0,a.jsx)(s.Provider,{value:{notifications:o,unreadCount:u,markAsRead,markAllAsRead,addNotification:e=>{let t={...e,id:Date.now().toString(),isRead:!1,createdAt:new Date().toISOString()};n(e=>[t,...e])}},children:t})}function useNotifications(){let e=(0,r.useContext)(s);if(void 0===e)throw Error("useNotifications must be used within a NotificationProvider");return e}},2853:function(){},1371:function(e){e.exports={style:{fontFamily:"'__Inter_e8ce0c', '__Inter_Fallback_e8ce0c'",fontStyle:"normal"},className:"__className_e8ce0c"}}},function(e){e.O(0,[42,971,472,744],function(){return e(e.s=4302)}),_N_E=e.O()}]);